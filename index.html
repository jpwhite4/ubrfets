<!doctype html>
<html>

<head>
	<title>UB Reasearch Foundation Timesheet Database</title>
	<link rel="stylesheet" href="styles/main.css"></link>
</head>

<body>
	<div>
		<select id="person">
			<option value="Select">Select Person</option>
		</select>
		<select id="reports">
			<option value="Select">Select Timesheet</option>
		</select>
	</div>
	<div id="viewer"></div>
	<script src="js/pdf.js"></script>
	<script src="js/pdfRender.js"></script>
	<script src="js/pdfForms.js"></script>
	<script src="js/database.js"></script>
	<script>
	'use strict';
	var formFields = {};
	

	var peepLen = Users.length;
	
	var peeps = document.getElementById("person");
	
	var reports = document.getElementById("reports");


	reports.addEventListener("change", function(ev){
		var target = ev.target,
			thisUser, thisTimesheet;
		if(target.value !== "Select"){
			thisUser = Users[peeps.value];
			thisTimesheet = thisUser.timeSheets[ev.target.value];
			
			setPdfField("Employee Name", thisUser.name);
			setPdfField("Person Number", thisUser.id);
			setPdfField("Report Period", target.options[target.selectedIndex].text);
			
			if(thisUser.isFullTime) {
				setPdfField("Full Time", true);
			}
			else {
				setPdfField("Part Time", true);
			}
			renderTimesheet();
		}
	});
	while(peepLen--) {
		peeps.add(new Option(Users[peepLen].name, peepLen));
	}
	peeps.addEventListener("change", function(ev) {
		var curLength = reports.options.length;
		while(curLength--){
			reports.remove(curLength);
		}
		reports.add(new Option("Select Timesheet", "Select"));
		if(ev.target.value !== "Select"){
			var usersTimesheets = Users[ev.target.value].timeSheets;
			var reportsLen = usersTimesheets.length;
			while(reportsLen--){
				var reportPeriod = usersTimesheets[reportsLen]["Report Period"];
				reports.add(new Option(reportPeriod.Month + " - " + reportPeriod.Year, reportsLen));
			}
		}
	})

	</script>
</body>

</html>
